<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.yedam.mealkit.shop.cart.mapper.CartMapper">
	<select id="cartSelectList" resultType="co.yedam.mealkit.shop.cart.service.CartVO">
		SELECT * FROM cart
		<if test="memberId != null">WHERE member_id = #{memberId}</if>
		ORDER BY cart_id DESC
	</select>

	<select id="cartSelect" resultType="co.yedam.mealkit.shop.cart.service.CartVO">
		SELECT * FROM cart WHERE cart_id = #{cartId}
	</select>
	
	<insert id="cartInsert" parameterType="co.yedam.mealkit.shop.cart.service.CartVO">
		<selectKey resultType="int" keyProperty="noticeId" order="BEFORE">
			SELECT NVL(MAX(cart_id),0)+1 FROM cart;
		</selectKey>
		
		INSERT INTO cart
		VALUES (#{cartId},#{cartCount},#{memberId},#{productId})
	</insert>
	
	<update id="cartUpdate" parameterType="co.yedam.mealkit.shop.cart.service.CartVO">
		UPDATE cart
		<set>
			<if test="cartCount != null AND !cartCount.equals('')">cart_count = #{cartCount},</if>
			<if test="productId != null AND !productId.equals('')">product_id = #{productId},</if>
		</set>
		WHERE cart_id = #{cartId}
	</update>
	
	<delete id="cartDelete" parameterType="co.yedam.mealkit.shop.cart.service.CartVO">
		DELETE FROM cart WHERE cart_id = #{cartId}
	</delete>

</mapper>